Title: SSG: server bundle fails at runtime with require.resolveWeak / module resolution errors

Summary
-------
When running `docusaurus build` (SSG enabled) the server bundle evaluation fails
at runtime with errors such as `TypeError: require.resolveWeak is not a function`
and subsequent `MODULE_NOT_FOUND` for `@theme/*` and `@site/*` virtual modules.

Environment
-----------
- Docusaurus: 3.9.2
- Node: v24.10.0 (issue also observed on Node 22 during local experiments)
- npm

Reproduction steps
------------------
1. Clone repository with the minimal site (attached or reproduce with a default
   Docusaurus site + blog/docs).
2. Run `npx docusaurus build` (do not set `DOCUSAURUS_SKIP_SSG`).
3. Observe SSG failing with `require.resolveWeak` TypeError and later module
   resolution errors for `@theme/*` and `@site/*`.
4. The `repro/run_repro.js` script included in the repo attempts to evaluate the
   `build/__server/server.bundle.js` and reproduces the same runtime errors.

Key logs
--------
- `TypeError: require.resolveWeak is not a function`
- `Error: Cannot find module '@theme/BlogListPage'` and similar for `@theme/DocsRoot`, `@site/src/pages/index.tsx` etc.

Notes & attempted mitigations
-----------------------------
- Local temporary workarounds applied to test fixes (in this repository):
  - Polyfilled `require.resolveWeak` in `ssgNodeRequire.createSSGRequire` (wrap require and expose `resolveWeak`).
  - Added `scripts/resolveWeakShim.js` to preload a shim during dev/build to patch `require.resolveWeak` and `File`.
  - Intercepted server.bundle reads to rewrite `require.resolveWeak` occurrences when necessary.
  - Stripped CSS imports from the server bundle before evaluation to avoid ESM/CSS loader syntax errors.
  - Added minimal placeholder `@theme/prism-include-languages` package and small `ssgNodeRequire` fallbacks for some `@theme/*` modules to move past resolution errors during testing.

Current repro output
--------------------
- After providing a wrapped `require` with `resolveWeak`, the VM evaluation hits a CSS parsing error (package `infima/dist/css/default/default.css`).
- When using the original approach, the initial error observed was `TypeError: require.resolveWeak is not a function`. The combined errors are captured in `repro/repro_output.txt` and by running `node repro/run_repro.cjs`.

*** End Patch
Root cause hypothesis
---------------------
The SSG pipeline evaluates the server bundle in a Node environment where:
- `require.resolveWeak` is not available (webpack-specific API expected at runtime)
- Some imports like `@theme/*` or `@site/*` may be treated as host requires rather
  than being resolved within the server bundle's webpack runtime, leading to
  Node's `require` attempting to resolve those packages and failing.

Suggested fixes
--------------
1. Ensure the SSG evaluation environment provides a safe `require.resolveWeak`.
2. Prefer evaluating the server bundle with its webpack runtime intact (vm script
   evaluation that creates `__webpack_require__`) rather than using `createRequire`
   which delegates resolution to Node's module loader.
3. Provide a robust mechanism to resolve `@theme/*` and `@site/*` virtual module
   references when running SSG, e.g., by letting the server bundle's internal
   module map fulfill those requires or mapping them to generated `build/__server`
   modules.

Attachments
-----------
- `build/__server/server.bundle.js` (generated by the failing build)
- `repro/run_repro.js` (minimal reproduction harness)
- build logs from `npm run build`

Please let me know if you'd like me to open a PR with a unit test or a minimal
repro repository that reproduces the failure on CI.
